import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as i,d as a}from"./app-015YzwbI.js";const n={},l=a(`<h1 id="sftp" tabindex="-1"><a class="header-anchor" href="#sftp"><span>sftp</span></a></h1><p>「Linux 命令详解」这个系列的文章将会介绍 Linux/Unix/macOS 系统中使用到的常用命令，包括该命令的简单介绍、常用参数解释以及最佳实践，如果需要快速使用这个命令，直接跳到最佳实践部分即可。</p><p>「Linux 命令详解」系列文章：</p><ul><li><a href="https://link.zhihu.com/?target=http%3A//jiayuanzhang.com/post/linux-sftp-tutorial/" target="_blank" rel="noopener noreferrer">Linux命令详解：SFTP</a></li></ul><h2 id="一、介绍" tabindex="-1"><a class="header-anchor" href="#一、介绍"><span>一、介绍</span></a></h2><p>SFTP（Secure File Transfer Protocol，安全文件传输协议）是一种基于可靠数据流（data stream），提供文件存取和管理的网络传输协议，它在网络协议层的结构如下图<a href="https://link.zhihu.com/?target=http%3A//jiayuanzhang.com/post/linux-sftp-tutorial/%23fn%3A1" target="_blank" rel="noopener noreferrer">1</a>所示：</p><figure><img src="https://pic3.zhimg.com/v2-e634bd69cc808310fe0380199dee9c52_b.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>与 FTP 协议相比，SFTP 在客户端与服务器间提供了一种更为安全的文件传输方式，如果你还在使用 FTP 来进行文件传输，强烈建议切换到更为安全的 SFTP 上来。</p><p>本篇文章将会介绍 SFTP 的链接，以及在交互式命令行中的一些常用命令，并对一些参数进行解释，最后给出实际使用中的最佳实践。目前已经有很多 GUI 客户端支持 SFTP 协议，但是不在本篇文章的讨论范围之内。</p><p>因为 SFTP 是基于 SSH 协议的，所以默认的身份认证方法与 SSH 协议保持一致。通常我们使用 SSH Key 来进行连接，如果你已经可以使用 SSH 连接到远程服务器上，那么可以使用以下命令来连接 SFTP：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp user_name@remote_server_address[:path]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果远程服务器自定义了连接的端口，可以使用 <code>-P</code> 参数：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp -P remote_port user_name@remote_server_address[:path]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>连接成功后将进入一个 SFTP 的解释器，可以发现命令行提示符变成了 <code>sftp&gt;</code>，使用 <code>exit</code> 命令可以退出连接。</p><p>如果连接地址存在 <code>path</code> 并且 <code>path</code> 不是一个目录，那么 SFTP 会直接从服务器端取回这个文件。</p><h2 id="三、连接参数详解" tabindex="-1"><a class="header-anchor" href="#三、连接参数详解"><span>三、连接参数详解</span></a></h2><ul><li><code>-B</code>: buffer_size，制定传输 buffer 的大小，更大的 buffer 会消耗更多的内存，默认为 32768 bytes；</li><li><code>-P</code>: port，制定连接的端口号；</li><li><code>-R</code>: num_requests，制定一次连接的请求数，可以略微提升传输速度，但是会增加内存的使用量。</li></ul><h2 id="四、目录管理" tabindex="-1"><a class="header-anchor" href="#四、目录管理"><span>四、目录管理</span></a></h2><p>在 SFTP 解释器中可以使用 <code>help</code> 命令来查看帮助文档。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; help</span></span>
<span class="line"><span>Available commands:</span></span>
<span class="line"><span>bye                                Quit sftp</span></span>
<span class="line"><span>cd path                            Change remote directory to &#39;path&#39;</span></span>
<span class="line"><span>chgrp grp path                     Change group of file &#39;path&#39; to &#39;grp&#39;</span></span>
<span class="line"><span>chmod mode path                    Change permissions of file &#39;path&#39; to &#39;mode&#39;</span></span>
<span class="line"><span>chown own path                     Change owner of file &#39;path&#39; to &#39;own&#39;</span></span>
<span class="line"><span>df [-hi] [path]                    Display statistics for current directory or</span></span>
<span class="line"><span>                                   filesystem containing &#39;path&#39;</span></span>
<span class="line"><span>exit                               Quit sftp</span></span>
<span class="line"><span>get [-afPpRr] remote [local]       Download file</span></span>
<span class="line"><span>reget [-fPpRr] remote [local]      Resume download file</span></span>
<span class="line"><span>reput [-fPpRr] [local] remote      Resume upload file</span></span>
<span class="line"><span>help                               Display this help text</span></span>
<span class="line"><span>lcd path                           Change local directory to &#39;path&#39;</span></span>
<span class="line"><span>lls [ls-options [path]]            Display local directory listing</span></span>
<span class="line"><span>lmkdir path                        Create local directory</span></span>
<span class="line"><span>ln [-s] oldpath newpath            Link remote file (-s for symlink)</span></span>
<span class="line"><span>lpwd                               Print local working directory</span></span>
<span class="line"><span>ls [-1afhlnrSt] [path]             Display remote directory listing</span></span>
<span class="line"><span>lumask umask                       Set local umask to &#39;umask&#39;</span></span>
<span class="line"><span>mkdir path                         Create remote directory</span></span>
<span class="line"><span>progress                           Toggle display of progress meter</span></span>
<span class="line"><span>put [-afPpRr] local [remote]       Upload file</span></span>
<span class="line"><span>pwd                                Display remote working directory</span></span>
<span class="line"><span>quit                               Quit sftp</span></span>
<span class="line"><span>rename oldpath newpath             Rename remote file</span></span>
<span class="line"><span>rm path                            Delete remote file</span></span>
<span class="line"><span>rmdir path                         Remove remote directory</span></span>
<span class="line"><span>symlink oldpath newpath            Symlink remote file</span></span>
<span class="line"><span>version                            Show SFTP version</span></span>
<span class="line"><span>!command                           Execute &#39;command&#39; in local shell</span></span>
<span class="line"><span>!                                  Escape to local shell</span></span>
<span class="line"><span>?                                  Synonym for help</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SFTP 解释器中预置了常用的命令，但是没有自带的 Bash 来得丰富。</p><p>1）显示当前的工作目录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; pwd</span></span>
<span class="line"><span>Remote working directory: /</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>2）查看当前目录的内容：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; ls</span></span>
<span class="line"><span>Summary.txt     info.html       temp.txt        testDirectory</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>3）使用 <code>-la</code> 参数可以以列表形式查看，并显示隐藏文件：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; ls -la</span></span>
<span class="line"><span>drwxr-xr-x    5 demouser   demouser       4096 Aug 13 15:11 .</span></span>
<span class="line"><span>drwxr-xr-x    3 root       root           4096 Aug 13 15:02 ..</span></span>
<span class="line"><span>-rw-------    1 demouser   demouser          5 Aug 13 15:04 .bash_history</span></span>
<span class="line"><span>-rw-r--r--    1 demouser   demouser        220 Aug 13 15:02 .bash_logout</span></span>
<span class="line"><span>-rw-r--r--    1 demouser   demouser       3486 Aug 13 15:02 .bashrc</span></span>
<span class="line"><span>drwx------    2 demouser   demouser       4096 Aug 13 15:04 .cache</span></span>
<span class="line"><span>-rw-r--r--    1 demouser   demouser        675 Aug 13 15:02 .profile</span></span>
<span class="line"><span>. . .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4）切换目录：</p><p>5）建立文件夹：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; mkdir anotherDirectory</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以上的命令都是用来操作远程服务器的，如果想要操作本地目录呢？只需要在每个命令前添加 <code>l</code>即可，例如显示本地操作目录下的文件：</p><p>使用 <code>!</code> 可以直接运行 Shell 中的指令：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; !df -h</span></span>
<span class="line"><span>Filesystem      Size   Used  Avail Capacity iused               ifree %iused  Mounted on</span></span>
<span class="line"><span>/dev/disk1s1   466Gi  360Gi  101Gi    79% 3642919 9223372036851132888    0%   /</span></span>
<span class="line"><span>devfs          336Ki  336Ki    0Bi   100%    1162                   0  100%   /dev</span></span>
<span class="line"><span>/dev/disk1s4   466Gi  4.0Gi  101Gi     4%       5 9223372036854775802    0%   /private/var/vm</span></span>
<span class="line"><span>map -hosts       0Bi    0Bi    0Bi   100%       0                   0  100%   /net</span></span>
<span class="line"><span>map auto_home    0Bi    0Bi    0Bi   100%       0                   0  100%   /home</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、传输文件" tabindex="-1"><a class="header-anchor" href="#五、传输文件"><span>五、传输文件</span></a></h2><h2 id="_5-1-从远程服务器拉取文件" tabindex="-1"><a class="header-anchor" href="#_5-1-从远程服务器拉取文件"><span>5.1 从远程服务器拉取文件</span></a></h2><p>使用 <code>get</code> 命令可以从远程服务器拉取文件到本地：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; get remoteFile [newName]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果不指定 <code>newName</code>，将使用和远程服务器相同的文件名。</p><p>使用 <code>-r</code> 参数可以拉取整个目录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; get -r remoteDirectory</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_5-2-从本地上传文件到服务器" tabindex="-1"><a class="header-anchor" href="#_5-2-从本地上传文件到服务器"><span>5.2 从本地上传文件到服务器</span></a></h2><p>使用 <code>put</code> 命令可以从本地上传文件到服务器：</p><p>同样的，可以使用 <code>-r</code> 参数来上传整个目录，但是有一点要注意，<strong>如果服务器上不存在这个目录需要首先新建</strong>：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp&gt; mkdir folderName</span></span>
<span class="line"><span>sftp&gt; put -r folderName</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="六、最佳实践" tabindex="-1"><a class="header-anchor" href="#六、最佳实践"><span>六、最佳实践</span></a></h2><p>1）连接远程服务器</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp remote_user@remote_host</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>2）使用端口进行连接</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sftp -P remote_port remote_user@remote_host</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>3）从远程服务器拉取文件</p><p>4）上传本地文件到服务器</p><p>5）查看远程服务器目录内容</p><p>6）查看本地目录内容</p><p>7）执行本地 Shell 命令</p><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><ul><li><a href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/SSH_File_Transfer_Protocol" target="_blank" rel="noopener noreferrer">SSH File Transfer Protocol</a></li><li><a href="https://link.zhihu.com/?target=https%3A//www.digitalocean.com/community/tutorials/how-to-use-sftp-to-securely-transfer-files-with-a-remote-server" target="_blank" rel="noopener noreferrer">How To Use SFTP to Securely Transfer Files with a Remote Server</a></li></ul>`,56),t=[l];function r(p,d){return i(),s("div",null,t)}const h=e(n,[["render",r],["__file","sftp.html.vue"]]),m=JSON.parse('{"path":"/%E7%B3%BB%E7%BB%9F/linux/sftp.html","title":"sftp","lang":"zh-CN","frontmatter":{"icon":"edit","date":"2022-01-01T00:00:00.000Z","category":["linux"],"tag":["sftp"],"description":"sftp 「Linux 命令详解」这个系列的文章将会介绍 Linux/Unix/macOS 系统中使用到的常用命令，包括该命令的简单介绍、常用参数解释以及最佳实践，如果需要快速使用这个命令，直接跳到最佳实践部分即可。 「Linux 命令详解」系列文章： Linux命令详解：SFTP 一、介绍 SFTP（Secure File Transfer Prot...","head":[["meta",{"property":"og:url","content":"https://blog.cizai.io/%E7%B3%BB%E7%BB%9F/linux/sftp.html"}],["meta",{"property":"og:site_name","content":"此在笔记"}],["meta",{"property":"og:title","content":"sftp"}],["meta",{"property":"og:description","content":"sftp 「Linux 命令详解」这个系列的文章将会介绍 Linux/Unix/macOS 系统中使用到的常用命令，包括该命令的简单介绍、常用参数解释以及最佳实践，如果需要快速使用这个命令，直接跳到最佳实践部分即可。 「Linux 命令详解」系列文章： Linux命令详解：SFTP 一、介绍 SFTP（Secure File Transfer Prot..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://pic3.zhimg.com/v2-e634bd69cc808310fe0380199dee9c52_b.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-17T17:45:45.000Z"}],["meta",{"property":"article:author","content":"cizai"}],["meta",{"property":"article:tag","content":"sftp"}],["meta",{"property":"article:published_time","content":"2022-01-01T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-17T17:45:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"sftp\\",\\"image\\":[\\"https://pic3.zhimg.com/v2-e634bd69cc808310fe0380199dee9c52_b.jpg\\"],\\"datePublished\\":\\"2022-01-01T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-17T17:45:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"cizai\\",\\"url\\":\\"https://blog.cizai.io\\"}]}"],["link",{"rel":"alternate","type":"application/atom+xml","href":"https://blog.cizai.io/atom.xml","title":"此在笔记 Atom Feed"}],["link",{"rel":"alternate","type":"application/json","href":"https://blog.cizai.io/feed.json","title":"此在笔记 JSON Feed"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://blog.cizai.io/rss.xml","title":"此在笔记 RSS Feed"}]]},"headers":[{"level":2,"title":"一、介绍","slug":"一、介绍","link":"#一、介绍","children":[]},{"level":2,"title":"三、连接参数详解","slug":"三、连接参数详解","link":"#三、连接参数详解","children":[]},{"level":2,"title":"四、目录管理","slug":"四、目录管理","link":"#四、目录管理","children":[]},{"level":2,"title":"五、传输文件","slug":"五、传输文件","link":"#五、传输文件","children":[]},{"level":2,"title":"5.1 从远程服务器拉取文件","slug":"_5-1-从远程服务器拉取文件","link":"#_5-1-从远程服务器拉取文件","children":[]},{"level":2,"title":"5.2 从本地上传文件到服务器","slug":"_5-2-从本地上传文件到服务器","link":"#_5-2-从本地上传文件到服务器","children":[]},{"level":2,"title":"六、最佳实践","slug":"六、最佳实践","link":"#六、最佳实践","children":[]},{"level":2,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]}],"git":{"createdTime":1710697545000,"updatedTime":1710697545000,"contributors":[{"name":"sampan","email":"lijc210@163.com","commits":1}]},"readingTime":{"minutes":4.65,"words":1394},"filePathRelative":"系统/linux/sftp.md","localizedDate":"2022年1月1日","excerpt":"\\n<p>「Linux 命令详解」这个系列的文章将会介绍 Linux/Unix/macOS 系统中使用到的常用命令，包括该命令的简单介绍、常用参数解释以及最佳实践，如果需要快速使用这个命令，直接跳到最佳实践部分即可。</p>\\n<p>「Linux 命令详解」系列文章：</p>\\n<ul>\\n<li><a href=\\"https://link.zhihu.com/?target=http%3A//jiayuanzhang.com/post/linux-sftp-tutorial/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Linux命令详解：SFTP</a></li>\\n</ul>","autoDesc":true}');export{h as comp,m as data};
